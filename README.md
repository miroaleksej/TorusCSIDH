# TorusCSIDH: Постквантовая Криптосистема для Bitcoin

TorusCSIDH — это постквантовая криптографическая система, предназначенная для замены ECDSA в Bitcoin. Она основана на CSIDH, но с критически важными улучшениями, обеспечивающими защиту от квантовых и классических атак.

## Особенности

- **Защита от квантовых атак**: Безопасна против атак с использованием квантовых компьютеров
- **Компактные ключи и подписи**: 64 байта для ключей, 96 байт для подписей
- **Совместимость с Bitcoin**: Soft fork через SegWit, формат Bech32m
- **Геометрическая проверка**: Уникальная защита от атак через "вырожденную топологию"
- **Полная математическая корректность**: Реализация полных Vélu's formulas и алгоритма Шуфа

## Отказ от чисел Бетти

TorusCSIDH полностью отказывается от сложных топологических концепций, включая числа Бетти. Вместо этого используется **чисто комбинаторный подход** с пятью геометрическими критериями:

1. **Цикломатическое число** (15%): μ = |E| - |V| + 1 ≥ 2
2. **Спектральный анализ** (30%): λ₂ - λ₁ > 1.5, λ₃ < 0.5, λ₄ ≥ 0.7
3. **Коэффициент кластеризации** (20%): C > 0.3
4. **Энтропия распределения степеней** (20%): H > 0.8
5. **Расстояние до базовой кривой** (15%): d < 3

Эти критерии работают вместе, обеспечивая 85% порог для принятия кривой как безопасной.

## Философия безопасности: за пределами алгебры

В TorusCSIDH при верификации подписи выполняется **многоуровневая структурная проверка** $E_{\text{eph}}$. Мы отказались от упрощенного подхода с фиксированными порогами и разработали комплексный критерий, который учитывает несколько независимых геометрических свойств графа изогений.

Это как проверка паспорта не только по фотографии и подписи, но и по микроструктуре бумаги, водяным знакам и другим скрытым характеристикам.

## Пример работы протокола

**Ситуация:** Алиса хочет подписать транзакцию для перевода биткоинов Бобу.

**Шаг 1: Генерация ключей (предварительно)**
- Алиса генерирует приватный ключ $d_A$ и публичную кривую $E_A = [d_A]E_0$

**Шаг 2: Подпись транзакции**
- Алиса генерирует эфемерную кривую $E_{\text{eph}}$
- Проверяет структурные свойства $E_{\text{eph}}$ через анализ локального подграфа
- Вычисляет подпись $S = (r, s)$, где $r$ - j-инвариант $E_{\text{eph}}$

**Шаг 3: Верификация подписи**
- Боб проверяет, что $E_{\text{eph}}$ имеет правильную структуру
- Проверяет коммутативность: $[d_{\text{eph}}][d_A]E_0 = [d_A][d_{\text{eph}}]E_0$

## Требования

- C++17 компилятор
- Библиотеки:
  - Boost Graph Library
  - Eigen
  - RELIC Toolkit
  - OpenSSL
  - Libsodium
  - GMP
  - TSS2 (для интеграции с TPM)

## Сборка

```bash
mkdir build
cd build
cmake ..
make
